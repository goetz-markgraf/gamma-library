let test-input = {
    "16,1,2,0,4,2,7,1,2,14"
    ""
}




let calculate-fuel target crab-list =
    crab-list ▷ map [crab →
        let dist = abs (crab - target)
        (dist × (dist + 1)) ÷ 2
    ]



let sum fuel-list =
    fuel-list ▷ fold 0 (+)



let produce-result input =
    let crab-list = input ▷ at 0 ▷ split-by "," ▷ map [it → it + 0]
    let min-crab = min crab-list
    let max-crab = max crab-list

    pipeline res {
        min-crab .. max-crab
        res ▷ map [target → target → (crab-list ▷ calculate-fuel target ▷ sum)]
        res ▷ fold res.first [acc fuel → acc.last > fuel.last ? fuel : acc]
        res.last
    }


test-input
▷ produce-result
▷ print



read-lines "src/test/resources/advent-of-code/day7.input"
▷ produce-result
